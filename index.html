<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ‘‘ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… ÙˆÙƒØ§Ù„Ø© Ø§Ù„Ù…Ù„ÙƒØ©</title>
    
    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            /* Ù†Ø¸Ø§Ù… Ø£Ù„ÙˆØ§Ù† Ø¥Ø¯Ø§Ø±ÙŠ Ø§Ø­ØªØ±Ø§ÙÙŠ */
            --primary: #1E40AF;
            --primary-light: #3B82F6;
            --primary-dark: #1E3A8A;
            --secondary: #7C3AED;
            --accent: #10B981;
            --warning: #F59E0B;
            --danger: #EF4444;
            --success: #10B981;
            --info: #3B82F6;
            
            --gradient: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            --gradient-light: linear-gradient(135deg, #3B82F6 0%, #8B5CF6 100%);
            
            /* Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù†Øµ */
            --text-primary: #1F2937;
            --text-secondary: #4B5563;
            --text-tertiary: #9CA3AF;
            --text-white: #FFFFFF;
            
            /* Ø®Ù„ÙÙŠØ§Øª */
            --bg-primary: #F9FAFB;
            --bg-secondary: #FFFFFF;
            --bg-card: #FFFFFF;
            --bg-sidebar: #1E293B;
            --bg-hover: rgba(30, 64, 175, 0.05);
            --bg-overlay: rgba(0, 0, 0, 0.7);
            
            /* ØªØ£Ø«ÙŠØ±Ø§Øª */
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            --shadow-2xl: 0 25px 50px -12px rgba(30, 64, 175, 0.25);
            
            /* Ø£Ù†ÙŠÙ…ÙŠØ´Ù† */
            --transition-fast: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-normal: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            
            /* Ø£Ø¨Ø¹Ø§Ø¯ */
            --radius-sm: 6px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-xl: 16px;
            --radius-2xl: 20px;
            --radius-full: 9999px;
            
            /* Ù…Ø³Ø§ÙØ§Øª */
            --space-xs: 4px;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;
            --space-2xl: 48px;
            --space-3xl: 64px;
            
            /* Ø£Ø¨Ø¹Ø§Ø¯ Ø«Ø§Ø¨ØªØ© */
            --sidebar-width: 280px;
            --header-height: 70px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html {
            font-size: 16px;
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Tajawal', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.5;
            min-height: 100vh;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* ===== Ù‡ÙŠÙƒÙ„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ===== */
        .admin-container {
            display: flex;
            min-height: 100vh;
        }

        /* ===== Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ ===== */
        .admin-sidebar {
            width: var(--sidebar-width);
            background: var(--bg-sidebar);
            color: white;
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            z-index: 1000;
            box-shadow: var(--shadow-xl);
            transition: var(--transition-normal);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: var(--space-xl);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }

        .sidebar-logo {
            width: 48px;
            height: 48px;
            background: var(--gradient-light);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            box-shadow: var(--shadow-md);
        }

        .sidebar-title {
            font-size: 1.25rem;
            font-weight: 800;
            color: white;
        }

        .sidebar-subtitle {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.7);
            margin-top: 2px;
        }

        .sidebar-nav {
            flex: 1;
            padding: var(--space-lg) 0;
            overflow-y: auto;
        }

        .nav-section {
            margin-bottom: var(--space-xl);
        }

        .nav-title {
            font-size: 0.75rem;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.5);
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 0 var(--space-xl) var(--space-sm);
            margin-bottom: var(--space-sm);
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            padding: var(--space-md) var(--space-xl);
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: var(--transition-fast);
            border-right: 3px solid transparent;
            position: relative;
        }

        .nav-link:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border-right-color: var(--primary-light);
        }

        .nav-link.active {
            background: rgba(255, 255, 255, 0.15);
            color: white;
            border-right-color: var(--accent);
        }

        .nav-link i {
            width: 20px;
            text-align: center;
            font-size: 1.125rem;
        }

        .nav-badge {
            position: absolute;
            left: var(--space-xl);
            background: var(--danger);
            color: white;
            font-size: 0.6875rem;
            font-weight: 700;
            padding: 2px 6px;
            border-radius: var(--radius-full);
            min-width: 20px;
            text-align: center;
        }

        .sidebar-footer {
            padding: var(--space-lg) var(--space-xl);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }

        .admin-avatar {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-full);
            overflow: hidden;
            background: var(--gradient-light);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
        }

        .admin-info {
            flex: 1;
        }

        .admin-name {
            font-size: 0.875rem;
            font-weight: 700;
            color: white;
        }

        .admin-role {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .logout-btn {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-full);
            border: none;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            cursor: pointer;
            transition: var(--transition-fast);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logout-btn:hover {
            background: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        /* ===== Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ===== */
        .admin-content {
            flex: 1;
            margin-right: var(--sidebar-width);
            min-height: 100vh;
        }

        /* ===== Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¹Ù„ÙˆÙŠ ===== */
        .admin-header {
            height: var(--header-height);
            background: var(--bg-secondary);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            padding: 0 var(--space-xl);
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow-sm);
        }

        .page-title {
            font-size: 1.5rem;
            font-weight: 900;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .page-title i {
            color: var(--primary);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }

        .search-box {
            position: relative;
            width: 300px;
        }

        .search-input {
            width: 100%;
            padding: 10px 16px 10px 44px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: var(--radius-full);
            font-family: inherit;
            font-size: 0.875rem;
            transition: var(--transition-fast);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
        }

        .search-icon {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-tertiary);
        }

        .header-btn {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-full);
            border: none;
            background: var(--bg-primary);
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition-fast);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .header-btn:hover {
            background: var(--bg-hover);
            color: var(--primary);
        }

        .notification-badge {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 8px;
            height: 8px;
            background: var(--danger);
            border-radius: 50%;
            border: 2px solid var(--bg-secondary);
        }

        /* ===== Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ===== */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: var(--space-lg);
            padding: var(--space-xl);
        }

        .stat-card {
            background: var(--bg-card);
            border-radius: var(--radius-xl);
            padding: var(--space-lg);
            box-shadow: var(--shadow-lg);
            border: 1px solid rgba(0, 0, 0, 0.05);
            transition: var(--transition-normal);
            position: relative;
            overflow: hidden;
        }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-xl);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 4px;
            height: 100%;
        }

        .stat-card.primary::before {
            background: var(--primary);
        }

        .stat-card.success::before {
            background: var(--success);
        }

        .stat-card.warning::before {
            background: var(--warning);
        }

        .stat-card.danger::before {
            background: var(--danger);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--space-md);
        }

        .stat-icon {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }

        .stat-card.primary .stat-icon {
            background: var(--primary);
        }

        .stat-card.success .stat-icon {
            background: var(--success);
        }

        .stat-card.warning .stat-icon {
            background: var(--warning);
        }

        .stat-card.danger .stat-icon {
            background: var(--danger);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 900;
            color: var(--text-primary);
            margin-bottom: 4px;
            line-height: 1;
        }

        .stat-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            font-weight: 600;
        }

        .stat-change {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 0.75rem;
            font-weight: 700;
            margin-top: var(--space-sm);
        }

        .stat-change.positive {
            color: var(--success);
        }

        .stat-change.negative {
            color: var(--danger);
        }

        /* ===== Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ===== */
        .content-section {
            padding: 0 var(--space-xl) var(--space-xl);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-xl);
        }

        .section-title {
            font-size: 1.25rem;
            font-weight: 900;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .section-actions {
            display: flex;
            gap: var(--space-sm);
        }

        .btn {
            padding: 10px 20px;
            border-radius: var(--radius-lg);
            font-weight: 600;
            font-size: 0.875rem;
            cursor: pointer;
            transition: var(--transition-normal);
            border: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background: var(--bg-primary);
            color: var(--text-primary);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
            transform: translateY(-1px);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #059669;
            transform: translateY(-2px);
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-warning:hover {
            background: #D97706;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: #DC2626;
            transform: translateY(-2px);
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 0.8125rem;
        }

        .table-container {
            background: var(--bg-card);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
        }

        .table-responsive {
            overflow-x: auto;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }

        .data-table th {
            background: var(--bg-primary);
            padding: var(--space-md) var(--space-lg);
            text-align: right;
            font-weight: 700;
            color: var(--text-secondary);
            font-size: 0.875rem;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            white-space: nowrap;
        }

        .data-table td {
            padding: var(--space-md) var(--space-lg);
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            font-size: 0.875rem;
        }

        .data-table tr:hover {
            background: var(--bg-hover);
        }

        .data-table tr:last-child td {
            border-bottom: none;
        }

        .user-cell {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-full);
            overflow: hidden;
            background: var(--gradient-light);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.875rem;
            font-weight: 700;
        }

        .user-info {
            display: flex;
            flex-direction: column;
        }

        .user-name {
            font-weight: 600;
            color: var(--text-primary);
        }

        .user-email {
            font-size: 0.75rem;
            color: var(--text-tertiary);
        }

        .status-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-pending {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .status-processing {
            background: rgba(59, 130, 246, 0.1);
            color: #3B82F6;
        }

        .status-completed {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .status-cancelled {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        .action-buttons {
            display: flex;
            gap: var(--space-xs);
        }

        /* ===== Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØµÙˆØ±Ø© ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ ===== */
        .image-preview {
            width: 60px;
            height: 60px;
            border-radius: var(--radius-md);
            overflow: hidden;
            cursor: pointer;
            border: 2px solid var(--primary);
            transition: var(--transition-fast);
        }

        .image-preview:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-md);
        }

        .image-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* ===== Ù…ÙˆØ¯Ø§Ù„ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØµÙˆØ±Ø© ===== */
        .modal-overlay {
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            background: var(--bg-overlay);
            backdrop-filter: blur(5px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: var(--space-xl);
        }

        .modal-overlay.active {
            display: flex;
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal {
            background: var(--bg-card);
            border-radius: var(--radius-2xl);
            max-width: 800px;
            width: 100%;
            max-height: 90vh;
            overflow: hidden;
            box-shadow: var(--shadow-2xl);
            animation: modalSlideIn 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-header {
            padding: var(--space-xl);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 900;
            color: var(--text-primary);
        }

        .modal-close {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-full);
            border: none;
            background: var(--bg-primary);
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition-fast);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            background: var(--danger);
            color: white;
        }

        .modal-body {
            padding: var(--space-xl);
            max-height: calc(90vh - 140px);
            overflow-y: auto;
        }

        .modal-image {
            width: 100%;
            height: auto;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            margin-bottom: var(--space-lg);
        }

        .modal-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-lg);
        }

        .info-group label {
            display: block;
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin-bottom: 4px;
            font-weight: 600;
        }

        .info-group .value {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.9375rem;
        }

        /* ===== Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø­Ø§Ù„Ø© ===== */
        .status-control {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
            margin-top: var(--space-lg);
            padding-top: var(--space-lg);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        .status-buttons {
            display: flex;
            gap: var(--space-sm);
            flex-wrap: wrap;
        }

        /* ===== Ø§Ù„ØªØµÙÙŠØ© ÙˆØ§Ù„Ø¨Ø­Ø« ===== */
        .filters {
            display: flex;
            gap: var(--space-md);
            margin-bottom: var(--space-xl);
            padding: var(--space-lg);
            background: var(--bg-card);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-sm);
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: var(--space-xs);
            min-width: 200px;
            flex: 1;
        }

        .filter-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-secondary);
        }

        .filter-select, .filter-input {
            padding: 10px 16px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: var(--radius-lg);
            font-family: inherit;
            font-size: 0.875rem;
            background: var(--bg-primary);
            transition: var(--transition-fast);
        }

        .filter-select:focus, .filter-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
        }

        /* ===== Ø§Ù„ØªØ­Ù…ÙŠÙ„ ===== */
        .loader-overlay {
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            background: var(--bg-overlay);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 3000;
        }

        .loader-overlay.active {
            display: flex;
        }

        .loader {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(30, 64, 175, 0.1);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ===== Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª ===== */
        .toast-container {
            position: fixed;
            top: var(--space-xl);
            left: var(--space-xl);
            right: var(--space-xl);
            z-index: 4000;
            pointer-events: none;
        }

        .toast {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-bottom: var(--space-sm);
            box-shadow: var(--shadow-2xl);
            border-right: 4px solid;
            animation: toastSlideIn 0.3s ease-out;
            display: flex;
            align-items: center;
            gap: var(--space-md);
            pointer-events: all;
            backdrop-filter: blur(10px);
        }

        @keyframes toastSlideIn {
            from {
                transform: translateY(-30px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .toast-icon {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.125rem;
            color: white;
            flex-shrink: 0;
        }

        .toast-success {
            border-color: var(--success);
        }

        .toast-success .toast-icon {
            background: var(--success);
        }

        .toast-error {
            border-color: var(--danger);
        }

        .toast-error .toast-icon {
            background: var(--danger);
        }

        .toast-info {
            border-color: var(--info);
        }

        .toast-info .toast-icon {
            background: var(--info);
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-size: 0.875rem;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .toast-message {
            font-size: 0.8125rem;
            color: var(--text-secondary);
        }

        /* ===== ØªØµÙ…ÙŠÙ… Ù…ØªØ¬Ø§ÙˆØ¨ ===== */
        @media (max-width: 1200px) {
            .admin-sidebar {
                width: 240px;
            }
            
            .admin-content {
                margin-right: 240px;
            }
        }

        @media (max-width: 992px) {
            .admin-sidebar {
                transform: translateX(100%);
                width: 280px;
            }
            
            .admin-sidebar.active {
                transform: translateX(0);
            }
            
            .admin-content {
                margin-right: 0;
            }
            
            .sidebar-toggle {
                display: block;
            }
        }

        @media (max-width: 768px) {
            :root {
                --space-xl: 24px;
                --space-lg: 20px;
            }
            
            .admin-header {
                padding: 0 var(--space-lg);
            }
            
            .content-section {
                padding: 0 var(--space-lg) var(--space-lg);
            }
            
            .search-box {
                width: 200px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: var(--space-md);
                padding: var(--space-lg);
            }
            
            .filters {
                flex-direction: column;
            }
            
            .filter-group {
                min-width: 100%;
            }
        }

        @media (max-width: 576px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .section-header {
                flex-direction: column;
                align-items: flex-start;
                gap: var(--space-md);
            }
            
            .section-actions {
                width: 100%;
                overflow-x: auto;
                padding-bottom: var(--space-xs);
            }
            
            .search-box {
                width: 100%;
            }
        }

        /* ===== Ø²Ø± ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ ===== */
        .sidebar-toggle {
            display: none;
            width: 40px;
            height: 40px;
            border-radius: var(--radius-full);
            border: none;
            background: var(--primary);
            color: white;
            cursor: pointer;
            position: fixed;
            bottom: var(--space-xl);
            left: var(--space-xl);
            z-index: 1001;
            box-shadow: var(--shadow-2xl);
            align-items: center;
            justify-content: center;
            transition: var(--transition-normal);
        }

        .sidebar-toggle:hover {
            transform: scale(1.1);
        }

        @media (max-width: 992px) {
            .sidebar-toggle {
                display: flex;
            }
        }
    </style>
</head>
<body>
    <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ -->
    <div class="admin-sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-logo">
                <i class="fas fa-crown"></i>
            </div>
            <div>
                <div class="sidebar-title">ÙˆÙƒØ§Ù„Ø© Ø§Ù„Ù…Ù„ÙƒØ©</div>
                <div class="sidebar-subtitle">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©</div>
            </div>
        </div>
        
        <div class="sidebar-nav">
            <div class="nav-section">
                <div class="nav-title">Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
                <a href="#" class="nav-link active" onclick="showSection('dashboard')">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</span>
                </a>
                <a href="#" class="nav-link" onclick="showSection('orders')">
                    <i class="fas fa-shopping-bag"></i>
                    <span>Ø§Ù„Ø·Ù„Ø¨Ø§Øª</span>
                    <span class="nav-badge" id="pending-orders-badge">0</span>
                </a>
                <a href="#" class="nav-link" onclick="showSection('users')">
                    <i class="fas fa-users"></i>
                    <span>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</span>
                </a>
                <a href="#" class="nav-link" onclick="showSection('packages')">
                    <i class="fas fa-gem"></i>
                    <span>Ø§Ù„Ø¨Ø§Ù‚Ø§Øª</span>
                </a>
            </div>
            
            <div class="nav-section">
                <div class="nav-title">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</div>
                <a href="#" class="nav-link" onclick="showSection('reports')">
                    <i class="fas fa-chart-line"></i>
                    <span>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</span>
                </a>
                <a href="#" class="nav-link" onclick="showSection('analytics')">
                    <i class="fas fa-chart-bar"></i>
                    <span>Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª</span>
                </a>
            </div>
            
            <div class="nav-section">
                <div class="nav-title">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</div>
                <a href="#" class="nav-link" onclick="showSection('settings')">
                    <i class="fas fa-cog"></i>
                    <span>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</span>
                </a>
                <a href="#" class="nav-link" onclick="showSection('admins')">
                    <i class="fas fa-user-shield"></i>
                    <span>Ø§Ù„Ù…Ø´Ø±ÙÙŠÙ†</span>
                </a>
            </div>
        </div>
        
        <div class="sidebar-footer">
            <div class="admin-avatar" id="admin-avatar">
                A
            </div>
            <div class="admin-info">
                <div class="admin-name" id="admin-name">Ø§Ù„Ù…Ø´Ø±Ù</div>
                <div class="admin-role" id="admin-role">Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…</div>
            </div>
            <button class="logout-btn" onclick="adminLogout()">
                <i class="fas fa-sign-out-alt"></i>
            </button>
        </div>
    </div>

    <!-- Ø²Ø± ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ -->
    <button class="sidebar-toggle" id="sidebarToggle">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <div class="admin-content">
        <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù†ÙˆØ§Ù† -->
        <div class="admin-header">
            <h1 class="page-title" id="page-title">
                <i class="fas fa-tachometer-alt"></i>
                Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
            </h1>
            <div class="header-actions">
                <div class="search-box">
                    <input type="text" class="search-input" id="search-input" placeholder="Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª...">
                    <i class="fas fa-search search-icon"></i>
                </div>
                <button class="header-btn" onclick="refreshData()">
                    <i class="fas fa-sync-alt"></i>
                </button>
                <button class="header-btn" onclick="showNotifications()">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge" id="notification-badge"></span>
                </button>
            </div>
        </div>

        <!-- Ù‚Ø³Ù… Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… -->
        <div class="admin-section active" id="dashboard-section">
            <!-- Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
            <div class="stats-grid">
                <div class="stat-card primary">
                    <div class="stat-header">
                        <div>
                            <div class="stat-value" id="total-orders">0</div>
                            <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</div>
                        </div>
                        <div class="stat-icon">
                            <i class="fas fa-shopping-bag"></i>
                        </div>
                    </div>
                    <div class="stat-change positive" id="orders-change">
                        <i class="fas fa-arrow-up"></i>
                        <span>0%</span>
                    </div>
                </div>
                
                <div class="stat-card success">
                    <div class="stat-header">
                        <div>
                            <div class="stat-value" id="completed-orders">0</div>
                            <div class="stat-label">Ø·Ù„Ø¨Ø§Øª Ù…ÙƒØªÙ…Ù„Ø©</div>
                        </div>
                        <div class="stat-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                    <div class="stat-change positive" id="completed-change">
                        <i class="fas fa-arrow-up"></i>
                        <span>0%</span>
                    </div>
                </div>
                
                <div class="stat-card warning">
                    <div class="stat-header">
                        <div>
                            <div class="stat-value" id="pending-orders">0</div>
                            <div class="stat-label">Ø·Ù„Ø¨Ø§Øª Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</div>
                        </div>
                        <div class="stat-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                    </div>
                    <div class="stat-change negative" id="pending-change">
                        <i class="fas fa-arrow-down"></i>
                        <span>0%</span>
                    </div>
                </div>
                
                <div class="stat-card danger">
                    <div class="stat-header">
                        <div>
                            <div class="stat-value" id="total-revenue">0$</div>
                            <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</div>
                        </div>
                        <div class="stat-icon">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                    </div>
                    <div class="stat-change positive" id="revenue-change">
                        <i class="fas fa-arrow-up"></i>
                        <span>0%</span>
                    </div>
                </div>
            </div>

            <!-- Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø© -->
            <div class="content-section">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-history"></i>
                        Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø©
                    </h2>
                    <div class="section-actions">
                        <button class="btn btn-secondary" onclick="refreshOrders()">
                            <i class="fas fa-sync-alt"></i>
                            ØªØ­Ø¯ÙŠØ«
                        </button>
                        <button class="btn btn-primary" onclick="exportOrders()">
                            <i class="fas fa-download"></i>
                            ØªØµØ¯ÙŠØ±
                        </button>
                    </div>
                </div>
                
                <div class="filters">
                    <div class="filter-group">
                        <label class="filter-label">Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨</label>
                        <select class="filter-select" id="status-filter" onchange="filterOrders()">
                            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                            <option value="pending">Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</option>
                            <option value="processing">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙ†ÙÙŠØ°</option>
                            <option value="completed">Ù…ÙƒØªÙ…Ù„</option>
                            <option value="cancelled">Ù…Ù„ØºÙŠ</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Ù…Ù† ØªØ§Ø±ÙŠØ®</label>
                        <input type="date" class="filter-input" id="date-from" onchange="filterOrders()">
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®</label>
                        <input type="date" class="filter-input" id="date-to" onchange="filterOrders()">
                    </div>
                </div>
                
                <div class="table-container">
                    <div class="table-responsive">
                        <table class="data-table" id="orders-table">
                            <thead>
                                <tr>
                                    <th>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</th>
                                    <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                                    <th>Ø§Ù„Ø¨Ø§Ù‚Ø©</th>
                                    <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                                    <th>Ø±Ù‚Ù… Linky</th>
                                    <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                    <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                                    <th>Ø§Ù„Ø¥ÙŠØµØ§Ù„</th>
                                    <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                                </tr>
                            </thead>
                            <tbody id="orders-table-body">
                                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ù‚Ø³Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ø§Ù‚Ø§Øª -->
        <div class="admin-section" id="packages-section">
            <div class="content-section">
                <div class="section-header">
                    <h2 class="section-title">
                        <i class="fas fa-gem"></i>
                        Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ø§Ù‚Ø§Øª
                    </h2>
                    <div class="section-actions">
                        <button class="btn btn-primary" onclick="showAddPackageModal()">
                            <i class="fas fa-plus"></i>
                            Ø¥Ø¶Ø§ÙØ© Ø¨Ø§Ù‚Ø© Ø¬Ø¯ÙŠØ¯Ø©
                        </button>
                    </div>
                </div>
                
                <div class="table-container">
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ù‚Ø©</th>
                                    <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Øª</th>
                                    <th>Ø§Ù„Ø³Ø¹Ø± ($)</th>
                                    <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                    <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡</th>
                                    <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                                </tr>
                            </thead>
                            <tbody id="packages-table-body">
                                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Ù…ÙˆØ¯Ø§Ù„ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø·Ù„Ø¨ -->
    <div class="modal-overlay" id="order-modal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨</h3>
                <button class="modal-close" onclick="closeModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="order-modal-body">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¬Ø§ÙØ§Ø³ÙƒØ±ÙŠØ¨Øª -->
            </div>
        </div>
    </div>

    <!-- Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
    <div class="loader-overlay" id="loader">
        <div class="loader"></div>
    </div>

    <!-- Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª -->
    <div class="toast-container" id="toast-container"></div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

    <script>
        // ===== ØªÙ‡ÙŠØ¦Ø© Firebase =====
        const firebaseConfig = {
            apiKey: "AIzaSyC_D7R6lQbvsTVR_0eUKql3bEaXvJhhYiM",
            authDomain: "linky-fa141.firebaseapp.com",
            databaseURL: "https://linky-fa141-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "linky-fa141",
            storageBucket: "linky-fa141.firebasestorage.app",
            messagingSenderId: "762955451050",
            appId: "1:762955451050:web:14dbca082bea9de8881ed3",
            measurementId: "G-4RRG7GBM9L"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();

        // ===== Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ =====
        let currentAdmin = null;
        let currentOrder = null;
        let allOrders = [];
        let filteredOrders = [];

        // ===== ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ =====
        document.addEventListener('DOMContentLoaded', async function() {
            await initAdminApp();
            setupEventListeners();
            loadStatistics();
            loadOrders();
            loadNotifications();
            
            // Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
            database.ref('admin_notifications').orderByChild('read').equalTo(false).on('value', (snapshot) => {
                loadNotifications();
            });
        });

        // ===== ØªÙ‡ÙŠØ¦Ø© ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ø´Ø±Ù =====
        async function initAdminApp() {
            try {
                showLoading(true);
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                auth.onAuthStateChanged(async (user) => {
                    if (user) {
                        currentAdmin = user;
                        await verifyAdminRole(user.uid);
                        loadAdminProfile(user.uid);
                    } else {
                        window.location.href = '/index.html';
                    }
                });
                
            } catch (error) {
                console.error('Error initializing admin app:', error);
                showToast('Ø®Ø·Ø£', 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…', 'error');
            } finally {
                showLoading(false);
            }
        }

        // ===== Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø´Ø±Ù =====
        async function verifyAdminRole(userId) {
            try {
                const snapshot = await database.ref('users/' + userId).once('value');
                const userData = snapshot.val();
                
                if (!userData || userData.role !== 'admin') {
                    showToast('ØºÙŠØ± Ù…ØµØ±Ø­', 'Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ§Øª Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…', 'error');
                    setTimeout(() => {
                        window.location.href = '/index.html';
                    }, 2000);
                    return false;
                }
                return true;
            } catch (error) {
                console.error('Error verifying admin role:', error);
                return false;
            }
        }

        // ===== ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø§Ù„Ù…Ø´Ø±Ù =====
        async function loadAdminProfile(userId) {
            try {
                const snapshot = await database.ref('users/' + userId).once('value');
                const userData = snapshot.val();
                
                if (userData) {
                    document.getElementById('admin-name').textContent = userData.username || 'Ø§Ù„Ù…Ø´Ø±Ù';
                    document.getElementById('admin-role').textContent = 'Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…';
                    
                    if (userData.profileImage) {
                        document.getElementById('admin-avatar').innerHTML = `<img src="${userData.profileImage}" style="width:100%;height:100%;object-fit:cover;">`;
                    } else {
                        const initials = (userData.username || 'Ù…').charAt(0);
                        document.getElementById('admin-avatar').textContent = initials;
                    }
                }
            } catch (error) {
                console.error('Error loading admin profile:', error);
            }
        }

        // ===== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª =====
        async function loadStatistics() {
            try {
                showLoading(true);
                
                // ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
                const ordersSnapshot = await database.ref('orders').once('value');
                const orders = ordersSnapshot.val();
                
                if (!orders) {
                    updateStats({ total: 0, completed: 0, pending: 0, revenue: 0 });
                    return;
                }
                
                const ordersArray = Object.values(orders);
                const total = ordersArray.length;
                const completed = ordersArray.filter(o => o.status === 'completed').length;
                const pending = ordersArray.filter(o => o.status === 'pending').length;
                const revenue = ordersArray.reduce((sum, order) => sum + (order.amount || 0), 0);
                
                updateStats({ total, completed, pending, revenue });
                
                // ØªØ­Ø¯ÙŠØ« Ø´Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ù„Ù‚Ø©
                document.getElementById('pending-orders-badge').textContent = pending;
                
            } catch (error) {
                console.error('Error loading statistics:', error);
                showToast('Ø®Ø·Ø£', 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª', 'error');
            } finally {
                showLoading(false);
            }
        }

        function updateStats({ total, completed, pending, revenue }) {
            document.getElementById('total-orders').textContent = total;
            document.getElementById('completed-orders').textContent = completed;
            document.getElementById('pending-orders').textContent = pending;
            document.getElementById('total-revenue').textContent = revenue.toFixed(2) + '$';
        }

        // ===== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª =====
        async function loadOrders() {
            try {
                showLoading(true);
                
                const ordersSnapshot = await database.ref('orders').once('value');
                const orders = ordersSnapshot.val();
                
                if (!orders) {
                    document.getElementById('orders-table-body').innerHTML = `
                        <tr>
                            <td colspan="9" style="text-align: center; padding: 40px; color: var(--text-secondary);">
                                <i class="fas fa-inbox" style="font-size: 48px; margin-bottom: 16px; opacity: 0.3;"></i>
                                <p style="font-size: 16px; margin-bottom: 8px;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¨Ø¹Ø¯</p>
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                allOrders = Object.entries(orders)
                    .map(([id, order]) => ({ id, ...order }))
                    .sort((a, b) => new Date(b.createdAt || b.date || 0) - new Date(a.createdAt || a.date || 0));
                
                filteredOrders = [...allOrders];
                renderOrdersTable();
                
            } catch (error) {
                console.error('Error loading orders:', error);
                showToast('Ø®Ø·Ø£', 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª', 'error');
            } finally {
                showLoading(false);
            }
        }

        // ===== Ø¹Ø±Ø¶ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ =====
        function renderOrdersTable() {
            const tbody = document.getElementById('orders-table-body');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            filteredOrders.forEach(order => {
                const statusClass = `status-${order.status || 'pending'}`;
                const statusText = {
                    'pending': 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©',
                    'processing': 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙ†ÙÙŠØ°',
                    'completed': 'Ù…ÙƒØªÙ…Ù„',
                    'cancelled': 'Ù…Ù„ØºÙŠ'
                }[order.status] || 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <strong>#${order.id.substring(0, 8).toUpperCase()}</strong>
                    </td>
                    <td>
                        <div class="user-cell">
                            <div class="user-avatar">
                                ${order.username ? order.username.charAt(0) : 'U'}
                            </div>
                            <div class="user-info">
                                <div class="user-name">${order.username || 'Ù…Ø³ØªØ®Ø¯Ù…'}</div>
                                <div class="user-email">${order.userEmail || 'Ø¨Ø±ÙŠØ¯ ØºÙŠØ± Ù…ØªØ§Ø­'}</div>
                            </div>
                        </div>
                    </td>
                    <td>
                        <strong>${order.coins ? order.coins.toLocaleString() : 0} Ø¹Ù…Ù„Ø©</strong>
                    </td>
                    <td>
                        <strong style="color: var(--primary);">${order.amount || 0}$</strong>
                    </td>
                    <td>
                        <code>${order.linkyId || 'ØºÙŠØ± Ù…ØªØ§Ø­'}</code>
                    </td>
                    <td>
                        <span class="status-badge ${statusClass}">${statusText}</span>
                    </td>
                    <td>
                        ${new Date(order.date || order.createdAt).toLocaleDateString('ar-EG')}
                    </td>
                    <td>
                        ${order.receiptImage ? `
                            <div class="image-preview" onclick="showOrderDetails('${order.id}')">
                                <img src="${order.receiptImage}" alt="ØµÙˆØ±Ø© Ø§Ù„Ø¥ÙŠØµØ§Ù„">
                            </div>
                        ` : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn btn-sm btn-success" onclick="updateOrderStatus('${order.id}', 'completed')" title="ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„">
                                <i class="fas fa-check"></i>
                            </button>
                            <button class="btn btn-sm btn-warning" onclick="updateOrderStatus('${order.id}', 'processing')" title="Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙ†ÙÙŠØ°">
                                <i class="fas fa-cog"></i>
                            </button>
                            <button class="btn btn-sm btn-danger" onclick="updateOrderStatus('${order.id}', 'cancelled')" title="Ø¥Ù„ØºØ§Ø¡">
                                <i class="fas fa-times"></i>
                            </button>
                            <button class="btn btn-sm btn-secondary" onclick="showOrderDetails('${order.id}')" title="Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // ===== ØªØµÙÙŠØ© Ø§Ù„Ø·Ù„Ø¨Ø§Øª =====
        function filterOrders() {
            const statusFilter = document.getElementById('status-filter').value;
            const dateFrom = document.getElementById('date-from').value;
            const dateTo = document.getElementById('date-to').value;
            
            filteredOrders = allOrders.filter(order => {
                // ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø©
                if (statusFilter && order.status !== statusFilter) return false;
                
                // ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ®
                const orderDate = new Date(order.date || order.createdAt);
                if (dateFrom) {
                    const fromDate = new Date(dateFrom);
                    if (orderDate < fromDate) return false;
                }
                if (dateTo) {
                    const toDate = new Date(dateTo);
                    toDate.setHours(23, 59, 59, 999);
                    if (orderDate > toDate) return false;
                }
                
                return true;
            });
            
            renderOrdersTable();
        }

        // ===== ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ =====
        async function updateOrderStatus(orderId, newStatus) {
            if (!confirm(`Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰ ${getStatusText(newStatus)}ØŸ`)) {
                return;
            }
            
            try {
                showLoading(true);
                
                const updates = {
                    status: newStatus,
                    updatedAt: Date.now()
                };
                
                if (newStatus === 'completed') {
                    updates.completedAt = new Date().toISOString();
                }
                
                await database.ref('orders/' + orderId).update(updates);
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ù„Ø¨ ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø©
                const orderIndex = allOrders.findIndex(o => o.id === orderId);
                if (orderIndex > -1) {
                    allOrders[orderIndex] = { ...allOrders[orderIndex], ...updates };
                }
                
                // Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø·Ù„Ø¨ Ù…ÙƒØªÙ…Ù„Ø§Ù‹
                if (newStatus === 'completed') {
                    const order = allOrders[orderIndex];
                    await database.ref('user_notifications/' + order.userId).push({
                        type: 'order_completed',
                        orderId: orderId,
                        message: `ØªÙ… ØªØ­ÙˆÙŠÙ„ ${order.coins} Ø¹Ù…Ù„Ø© Ø¥Ù„Ù‰ Ø­Ø³Ø§Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­!`,
                        date: new Date().toISOString(),
                        read: false
                    });
                }
                
                showToast('ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«', `ØªÙ… ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰ ${getStatusText(newStatus)}`, 'success');
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø¯ÙˆÙ„ ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                renderOrdersTable();
                loadStatistics();
                
            } catch (error) {
                console.error('Error updating order status:', error);
                showToast('Ø®Ø·Ø£', 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨', 'error');
            } finally {
                showLoading(false);
            }
        }

        function getStatusText(status) {
            const statusMap = {
                'pending': 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©',
                'processing': 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙ†ÙÙŠØ°',
                'completed': 'Ù…ÙƒØªÙ…Ù„',
                'cancelled': 'Ù…Ù„ØºÙŠ'
            };
            return statusMap[status] || status;
        }

        // ===== Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ =====
        async function showOrderDetails(orderId) {
            try {
                showLoading(true);
                
                const order = allOrders.find(o => o.id === orderId);
                if (!order) {
                    showToast('Ø®Ø·Ø£', 'Ø§Ù„Ø·Ù„Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
                    return;
                }
                
                currentOrder = order;
                
                const modalBody = document.getElementById('order-modal-body');
                modalBody.innerHTML = `
                    ${order.receiptImage ? `
                        <div style="text-align: center; margin-bottom: 24px;">
                            <img src="${order.receiptImage}" class="modal-image" alt="ØµÙˆØ±Ø© Ø¥ÙŠØµØ§Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„">
                            <div style="margin-top: 8px; color: var(--text-secondary); font-size: 0.875rem;">
                                ØµÙˆØ±Ø© Ø¥ÙŠØµØ§Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„
                            </div>
                        </div>
                    ` : ''}
                    
                    <div class="modal-info">
                        <div class="info-group">
                            <label>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</label>
                            <div class="value">${order.id}</div>
                        </div>
                        <div class="info-group">
                            <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                            <div class="value">${order.username || 'ØºÙŠØ± Ù…ØªØ§Ø­'}</div>
                        </div>
                        <div class="info-group">
                            <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                            <div class="value">${order.userEmail || 'ØºÙŠØ± Ù…ØªØ§Ø­'}</div>
                        </div>
                        <div class="info-group">
                            <label>Ø±Ù‚Ù… Linky</label>
                            <div class="value">${order.linkyId || 'ØºÙŠØ± Ù…ØªØ§Ø­'}</div>
                        </div>
                        <div class="info-group">
                            <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                            <div class="value">${order.senderPhone || 'ØºÙŠØ± Ù…ØªØ§Ø­'}</div>
                        </div>
                        <div class="info-group">
                            <label>Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨</label>
                            <div class="value">${order.whatsappNumber || 'ØºÙŠØ± Ù…ØªØ§Ø­'}</div>
                        </div>
                        <div class="info-group">
                            <label>Ø§Ù„Ø¨Ø§Ù‚Ø©</label>
                            <div class="value">${order.coins ? order.coins.toLocaleString() : 0} Ø¹Ù…Ù„Ø©</div>
                        </div>
                        <div class="info-group">
                            <label>Ø§Ù„Ù…Ø¨Ù„Øº</label>
                            <div class="value">${order.amount || 0}$</div>
                        </div>
                        <div class="info-group">
                            <label>Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©</label>
                            <div class="value">
                                <span class="status-badge status-${order.status || 'pending'}">
                                    ${getStatusText(order.status)}
                                </span>
                            </div>
                        </div>
                        <div class="info-group">
                            <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨</label>
                            <div class="value">${new Date(order.date || order.createdAt).toLocaleString('ar-EG')}</div>
                        </div>
                        ${order.completedAt ? `
                            <div class="info-group">
                                <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ÙƒÙ…Ø§Ù„</label>
                                <div class="value">${new Date(order.completedAt).toLocaleString('ar-EG')}</div>
                            </div>
                        ` : ''}
                    </div>
                    
                    <div class="status-control">
                        <label style="font-weight: 600; color: var(--text-primary); margin-bottom: 8px;">ØªØºÙŠÙŠØ± Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨:</label>
                        <div class="status-buttons">
                            <button class="btn btn-sm btn-success" onclick="updateOrderStatus('${order.id}', 'completed'); closeModal()">
                                <i class="fas fa-check"></i> ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„
                            </button>
                            <button class="btn btn-sm btn-warning" onclick="updateOrderStatus('${order.id}', 'processing'); closeModal()">
                                <i class="fas fa-cog"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙ†ÙÙŠØ°
                            </button>
                            <button class="btn btn-sm btn-danger" onclick="updateOrderStatus('${order.id}', 'cancelled'); closeModal()">
                                <i class="fas fa-times"></i> Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø·Ù„Ø¨
                            </button>
                        </div>
                    </div>
                `;
                
                document.getElementById('order-modal').classList.add('active');
                
            } catch (error) {
                console.error('Error showing order details:', error);
                showToast('Ø®Ø·Ø£', 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨', 'error');
            } finally {
                showLoading(false);
            }
        }

        // ===== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª =====
        async function loadNotifications() {
            try {
                const snapshot = await database.ref('admin_notifications').orderByChild('read').equalTo(false).once('value');
                const notifications = snapshot.val();
                const count = notifications ? Object.keys(notifications).length : 0;
                
                document.getElementById('notification-badge').style.display = count > 0 ? 'block' : 'none';
                document.getElementById('notification-badge').textContent = count > 9 ? '9+' : count;
                
            } catch (error) {
                console.error('Error loading notifications:', error);
            }
        }

        // ===== Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª =====
        async function showNotifications() {
            try {
                showLoading(true);
                
                const snapshot = await database.ref('admin_notifications').orderByChild('createdAt').limitToLast(20).once('value');
                const notifications = snapshot.val();
                
                if (!notifications) {
                    showToast('Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª', 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©', 'info');
                    return;
                }
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙÙŠ Ù†Ø§ÙØ°Ø© Ù…Ù†Ø¨Ø«Ù‚Ø©
                const notificationsList = Object.entries(notifications)
                    .map(([id, notif]) => ({
                        id,
                        ...notif
                    }))
                    .sort((a, b) => new Date(b.createdAt || b.date) - new Date(a.createdAt || a.date));
                
                let notificationsHTML = `
                    <div style="background: white; border-radius: 12px; padding: 20px; max-width: 400px; box-shadow: 0 10px 25px rgba(0,0,0,0.1);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h3 style="margin: 0; color: var(--text-primary);">Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª</h3>
                            <button onclick="markAllNotificationsAsRead()" style="background: none; border: none; color: var(--primary); cursor: pointer;">
                                ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙƒÙ„ ÙƒÙ…Ù‚Ø±ÙˆØ¡
                            </button>
                        </div>
                        <div style="max-height: 400px; overflow-y: auto;">
                `;
                
                notificationsList.forEach(notif => {
                    const isNew = !notif.read;
                    notificationsHTML += `
                        <div style="padding: 12px; border-bottom: 1px solid rgba(0,0,0,0.1); ${isNew ? 'background: rgba(30, 64, 175, 0.05);' : ''}">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                <strong style="color: var(--text-primary);">Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</strong>
                                <span style="font-size: 0.75rem; color: var(--text-secondary);">
                                    ${new Date(notif.date || notif.createdAt).toLocaleDateString('ar-EG')}
                                </span>
                            </div>
                            <div style="font-size: 0.875rem; color: var(--text-secondary);">
                                ${notif.username || 'Ù…Ø³ØªØ®Ø¯Ù…'} - ${notif.coins ? notif.coins.toLocaleString() : 0} Ø¹Ù…Ù„Ø©
                            </div>
                            ${isNew ? `
                                <button onclick="markNotificationAsRead('${notif.id}')" style="margin-top: 8px; background: var(--primary); color: white; border: none; padding: 4px 12px; border-radius: 6px; font-size: 0.75rem; cursor: pointer;">
                                    ØªØ¹ÙŠÙŠÙ† ÙƒÙ…Ù‚Ø±ÙˆØ¡
                                </button>
                            ` : ''}
                        </div>
                    `;
                });
                
                notificationsHTML += `
                        </div>
                    </div>
                `;
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ù„Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
                const notificationsEl = document.createElement('div');
                notificationsEl.innerHTML = notificationsHTML;
                notificationsEl.style.position = 'fixed';
                notificationsEl.style.top = '70px';
                notificationsEl.style.left = '50%';
                notificationsEl.style.transform = 'translateX(-50%)';
                notificationsEl.style.zIndex = '2000';
                notificationsEl.style.animation = 'fadeIn 0.3s ease-out';
                
                // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« Ù„Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
                const closeNotifications = (e) => {
                    if (!notificationsEl.contains(e.target)) {
                        document.body.removeChild(notificationsEl);
                        document.removeEventListener('click', closeNotifications);
                    }
                };
                
                setTimeout(() => {
                    document.addEventListener('click', closeNotifications);
                }, 100);
                
                document.body.appendChild(notificationsEl);
                
            } catch (error) {
                console.error('Error showing notifications:', error);
                showToast('Ø®Ø·Ø£', 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª', 'error');
            } finally {
                showLoading(false);
            }
        }

        // ===== ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± ÙƒÙ…Ù‚Ø±ÙˆØ¡ =====
        async function markNotificationAsRead(notificationId) {
            try {
                await database.ref('admin_notifications/' + notificationId).update({
                    read: true,
                    readAt: Date.now()
                });
                
                loadNotifications();
                
            } catch (error) {
                console.error('Error marking notification as read:', error);
            }
        }

        // ===== ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙƒÙ…Ù‚Ø±ÙˆØ¡Ø© =====
        async function markAllNotificationsAsRead() {
            try {
                const snapshot = await database.ref('admin_notifications').orderByChild('read').equalTo(false).once('value');
                const notifications = snapshot.val();
                
                if (notifications) {
                    const updates = {};
                    Object.keys(notifications).forEach(id => {
                        updates[`admin_notifications/${id}/read`] = true;
                        updates[`admin_notifications/${id}/readAt`] = Date.now();
                    });
                    
                    await database.ref().update(updates);
                    showToast('ØªÙ…', 'ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙƒÙ…Ù‚Ø±ÙˆØ¡Ø©', 'success');
                    loadNotifications();
                }
                
            } catch (error) {
                console.error('Error marking all notifications as read:', error);
                showToast('Ø®Ø·Ø£', 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ÙƒÙ…Ù‚Ø±ÙˆØ¡Ø©', 'error');
            }
        }

        // ===== Ø¹Ø±Ø¶ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… =====
        function showSection(sectionId) {
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            document.querySelector(`[onclick="showSection('${sectionId}')"]`).classList.add('active');
            
            // ØªØ­Ø¯ÙŠØ« Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØµÙØ­Ø©
            const titles = {
                'dashboard': { icon: 'fa-tachometer-alt', text: 'Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…' },
                'orders': { icon: 'fa-shopping-bag', text: 'Ø§Ù„Ø·Ù„Ø¨Ø§Øª' },
                'users': { icon: 'fa-users', text: 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†' },
                'packages': { icon: 'fa-gem', text: 'Ø§Ù„Ø¨Ø§Ù‚Ø§Øª' },
                'reports': { icon: 'fa-chart-line', text: 'Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±' },
                'analytics': { icon: 'fa-chart-bar', text: 'Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª' },
                'settings': { icon: 'fa-cog', text: 'Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª' },
                'admins': { icon: 'fa-user-shield', text: 'Ø§Ù„Ù…Ø´Ø±ÙÙŠÙ†' }
            };
            
            const title = titles[sectionId] || titles.dashboard;
            document.getElementById('page-title').innerHTML = `
                <i class="fas ${title.icon}"></i>
                ${title.text}
            `;
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
            document.querySelectorAll('.admin-section').forEach(section => {
                section.classList.remove('active');
            });
            
            document.getElementById(`${sectionId}-section`).classList.add('active');
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…Ø­Ù…ÙˆÙ„Ø©
            if (window.innerWidth <= 992) {
                document.getElementById('sidebar').classList.remove('active');
            }
        }

        // ===== Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« =====
        function setupEventListeners() {
            // Ø¨Ø­Ø« Ø§Ù„Ø·Ù„Ø¨Ø§Øª
            const searchInput = document.getElementById('search-input');
            if (searchInput) {
                searchInput.addEventListener('input', (e) => {
                    const searchTerm = e.target.value.toLowerCase();
                    if (searchTerm) {
                        filteredOrders = allOrders.filter(order => 
                            order.id.toLowerCase().includes(searchTerm) ||
                            order.username?.toLowerCase().includes(searchTerm) ||
                            order.userEmail?.toLowerCase().includes(searchTerm) ||
                            order.linkyId?.toLowerCase().includes(searchTerm)
                        );
                    } else {
                        filteredOrders = [...allOrders];
                    }
                    renderOrdersTable();
                });
            }
            
            // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ
            const sidebarToggle = document.getElementById('sidebarToggle');
            if (sidebarToggle) {
                sidebarToggle.addEventListener('click', () => {
                    document.getElementById('sidebar').classList.toggle('active');
                });
            }
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
            document.addEventListener('click', (e) => {
                const modal = document.getElementById('order-modal');
                if (modal && modal.classList.contains('active') && e.target === modal) {
                    closeModal();
                }
            });
        }

        // ===== ÙˆØ¸Ø§Ø¦Ù Ù…Ø³Ø§Ø¹Ø¯Ø© =====
        function showLoading(show) {
            document.getElementById('loader').classList.toggle('active', show);
        }

        function showToast(title, message, type = 'success') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            
            const icons = {
                'success': 'fa-check-circle',
                'error': 'fa-exclamation-circle',
                'info': 'fa-info-circle'
            };
            
            toast.innerHTML = `
                <div class="toast-icon">
                    <i class="fas ${icons[type] || icons.info}"></i>
                </div>
                <div class="toast-content">
                    <div class="toast-title">${title}</div>
                    <div class="toast-message">${message}</div>
                </div>
            `;
            
            container.appendChild(toast);
            
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateY(-20px)';
                setTimeout(() => {
                    if (toast.parentNode === container) {
                        container.removeChild(toast);
                    }
                }, 300);
            }, 5000);
            
            toast.addEventListener('click', () => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateY(-20px)';
                setTimeout(() => {
                    if (toast.parentNode === container) {
                        container.removeChild(toast);
                    }
                }, 300);
            });
        }

        function closeModal() {
            document.getElementById('order-modal').classList.remove('active');
        }

        function refreshData() {
            loadStatistics();
            loadOrders();
            showToast('ØªØ­Ø¯ÙŠØ«', 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }

        function refreshOrders() {
            loadOrders();
        }

        function exportOrders() {
            // ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ…Ù„Ù CSV
            const csv = convertToCSV(filteredOrders);
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', `orders_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showToast('ØªØµØ¯ÙŠØ±', 'ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
        }

        function convertToCSV(orders) {
            const headers = ['Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨', 'Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…', 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ', 'Ø§Ù„Ø¨Ø§Ù‚Ø©', 'Ø§Ù„Ù…Ø¨Ù„Øº', 'Ø±Ù‚Ù… Linky', 'Ø§Ù„Ø­Ø§Ù„Ø©', 'Ø§Ù„ØªØ§Ø±ÙŠØ®'];
            const rows = orders.map(order => [
                order.id,
                order.username || '',
                order.userEmail || '',
                `${order.coins || 0} Ø¹Ù…Ù„Ø©`,
                `${order.amount || 0}$`,
                order.linkyId || '',
                getStatusText(order.status),
                new Date(order.date || order.createdAt).toLocaleString('ar-EG')
            ]);
            
            const csvContent = [
                headers.join(','),
                ...rows.map(row => row.map(cell => `"${cell}"`).join(','))
            ].join('\n');
            
            return csvContent;
        }

        function showAddPackageModal() {
            showToast('Ù…Ø¹Ù„ÙˆÙ…Ø©', 'Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© ÙÙŠ ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¯Ù…', 'info');
        }

        // ===== ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬ Ø§Ù„Ù…Ø´Ø±Ù =====
        async function adminLogout() {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…ØŸ')) {
                try {
                    showLoading(true);
                    await auth.signOut();
                    window.location.href = '/index.html';
                } catch (error) {
                    console.error('Error signing out:', error);
                    showToast('Ø®Ø·Ø£', 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬', 'error');
                    showLoading(false);
                }
            }
        }
    </script>
</body>
</html>
